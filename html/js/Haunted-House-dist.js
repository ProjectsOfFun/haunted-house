"use strict";var objects={painting:{name:"a beautiful painting",description:"It depicts a smiling, golden-haired child.",location:"spookyRoom",portable:!0,score:1},ring:{name:"a golden ring",location:"coffin",portable:!0,score:1},"magic spells":{name:"a tome of magic spells",description:"There is something written on it.",readableText:"The text reads: Use this word with care, 'Xzanfar'.",location:"secretRoom",readable:!0,portable:!0,score:1},tome:{synonym:"magic spells"},goblet:{name:"a jewelled goblet",description:"It made of shiny metal and encrusted with sparkling jewels.",location:"frontTower",portable:!0,score:1},scroll:{location:"rearTurretRoom",portable:!0,readable:!0,description:"The script is in an alien tongue.",readableText:'It says "Klatu Borata Nickto."',score:1},coins:{location:"darkAlcove",portable:!0,score:1},statue:{name:"an ebony statue",description:"It looks African and origin and is most likely very valuable.",location:"hallWithLockedDoor",portable:!0,score:1},candlestick:{location:"library",portable:!0,score:1},matches:{location:"kitchen",portable:!0},vacuum:{name:"a tiny vacuum",description:"It's a tiny, battery-powered vacuum cleaner. Perfect for capturing  dust and much more!",location:"gloomyPassage",portable:!0},batteries:{location:"poolOfLight",portable:!0},shovel:{name:"a shovel",description:"It's a small garden shovel. Perfect for digging!",location:"weedPatch",portable:!0},axe:{name:"an axe",description:"Although a bit rusty, the blade is sharp. Looks like one <em>swing</em> could do some serious damage.",location:"byWoodpile",portable:!0},rope:{name:"a rope tied to a tree",location:"blastedTree",portable:!0,overrides:{get:function(){flags.ropeTiedToTree?(verbs.get.action("rope",objects.rope),objects.rope.name="a length of rope",flags.ropeTiedToTree=!1):verbs.get.action("rope",objects.rope)},climb:function(){flags.ropeTiedToTree&&isRoom("blastedTree")?(message="You use the rope to climb the tree.",objects.rope.omnipresence=!0,currentRoom=rooms.inTheTree):flags.ropeTiedToTree&&isRoom("inTheTree")?(message="You use the rope to climb down.",objects.rope.omnipresence=!1,currentRoom=rooms.blastedTree):message="It isn't attached to anything!"}}},boat:{name:"a boat",description:"It's rickety and old, but it should float.",location:"cliffPathByMarsh",overrides:{get:function(){objectInRange("boat")&&(message=flags.inBoat?"Um, you are sitting in the boat. Besides, it's too big to carry.":"It's too big to carry around. It will carry you if you board it.")}}},aerosol:{name:"a can of aerosol",description:"The can reads, 'For the highest hair. Warning: do not spray on small animals.'",location:"debris",portable:!0,flamable:!0,overrides:{light:function(){message="player"==objects.aerosol.location&&"player"==objects.matches.location?"An explosive fireball sprays out of the can of aerosol! You can kiss your eyebrows goodbye.":"player"==objects.aerosol.location?"You have nothing to ignite the aerosol.":"You are not holding any aerosol."}}},can:{synonym:"aerosol"},candle:{name:"a candle",location:"drawer",portable:!0},key:{name:"a key",description:"It's made of brass and it probably unlocks something, right?",location:"coat",portable:!0},door:{location:"hallWithLockedDoor",description:"It's made of a thick, unbreakable wood.",locked:!0,open:!1,overrides:{unlock:function(){var e=objects.door;objectInRange(e)&&(isCarrying("key")&&!0===e.locked?(message="You slowly turn the key and unlock the door!",rooms.hallWithLockedDoor.exits.s="steepMarbleStairs",e.locked=!1,e.open=!0):message=!1===e.locked?"It's already unlocked.":"This door requires a key!")},open:function(){message=objects.door.locked?"It's locked!":"It's already open."}}},bats:{},ghosts:{},drawer:{location:"study",description:"It's a small side drawer. It's closed.",isOpen:!1,overrides:{open:function(){var e=objects.drawer;currentRoom.rid===e.location&&(e.isOpen||"drawer"!==objects.candle.location?e.isOpen?message="It's already open.":(message="You slide open the drawer.",e.description="The small side drawer is open and empty.",e.isOpen=!0):(message="You slide the drawer open revealing a candle.",e.description="The small side drawer is open and empty.",objects.candle.location="study",e.isOpen=!0))}}},desk:{location:"study",description:"Most of the desks a littered with paper scraps and other unimportant items. However, one has an ornamented drawer."},desks:{synonym:"desk"},coat:{name:"a dusty old coat",description:"It's a dusty old rancher's coat.",location:"cupboard",portable:!0,overrides:{look:function(){var e=objects.coat;"coat"!=objects.key.location||"player"!=e.location&&currentRoom.rid!=e.location?verbs.look.action("coat",e):(message="As you search through the old coat you find a key in the pocket.",sndKey.play(),objects.key.location=currentRoom.rid)}}},pocket:{synonym:"coat"},rubbish:{location:"yard",description:"The garbage has decomposed into a heap of goo. That's very disgusting!"},message:{location:"sideOfHouse",description:"It's written in blood!",readable:!0,readableText:'It says, "Seek the word to dispell the barrier."'},coffin:{location:"deepCellar",overrides:{open:function(){var e=objects.coffin;currentRoom.rid===e.location&&("coffin"===objects.ring.location?(message="You slowly raise the lid revealing... a ring!",objects.ring.location=e.location):message="That's creepy!")}}},books:{description:"They are demonic works.",readable:!0,readableText:"You are unable to make sense of the ancient writings.",location:"library"},xzanfar:{},spells:{synonym:"magic spells"},north:{},south:{},west:{},east:{},up:{},down:{},air:{description:"It can't be seen.",omnipresence:!0}},rooms={darkCorner:{name:"Dark Corner",description:"The far corner of the yard is covered in dark shadow. The property continues to the south around the west side of the mansion.",exits:{e:"overgrownGarden",s:"cornerOfHouse"},onEnter:function(){Math.random()>.5&&(message="You hear an owl hooting off in the distance.",sndOwl.play())}},overgrownGarden:{name:"Overgrown Garden",description:"This once was a fertile garden full of vegetables and herbs. Now it has been choked and overtaken by prickly weeds.",exits:{w:"darkCorner",e:"byWoodpile"},scenery:{weeds:"They have grown almost to waist level and are covered in sharp thorns.",thorns:"Best not touch get close."}},byWoodpile:{name:"Large Wood Pile",description:"A large stack of wood is haphazardly piled against the side of the mansion.",exits:{w:"overgrownGarden",e:"yard"},scenery:{pile:"The wood is stacked about a meter high.",wood:"It's damp, mossy, and probably no longer useful."}},yard:{name:"Yard by Rubbish",description:"Despite being years since anyone lived here, the rubbish bins still emit a sour stench. The back entrance to the house lies to the south.",exits:{w:"byWoodpile",e:"weedPatch",s:"sculleryDoor"},scenery:{bins:"They are filled with rubbish. Small bones are scattered around their base.",bones:"Racoons perhaps?"}},weedPatch:{name:"Weed Patch",description:"This area doesn't look like it has ever been anything but the overgrown weed patch you see before you.",exits:{w:"yard",e:"forest"},scenery:{weeds:"They look itchy.",patch:"It would take an industrial grade mower to clear this area.","weed patch":"It would take an industrial grade mower to clear this area."}},forest:{name:"Forest",description:"This area of sparse forest grows right up to the north side of the house. Most of the trees' branches are bereft of leaves.",exits:{w:"weedPatch",e:"thickForest"},scenery:{trees:"They are tall and baren."}},thickForest:{name:"Thick Forest",description:"Here your progress is slowed considerably by the dense trees in this area of the forest.",exits:{w:"forest",e:"blastedTree",s:"clearing"},scenery:{trees:"They are tall, baren, and growing very close to each other."}},blastedTree:{name:"Blasted Tree",description:"This corner of the property is eerily dim. Looming above is an ominous tree. It's leafless branches crackle in the breeze.",exits:{w:"thickForest",s:"path"},onEnter:function(){objects.rope.omnipresence=!1},scenery:{tree:"The tree is devoid of leaves and has an almost demon-like appearance.",branches:"The branches are devoid of leaves."}},cornerOfHouse:{name:"Corner of the House",description:"The moonlight is obscured by the mansion to the east as you make your way around the back corner of the house.",exits:{n:"darkCorner",s:"sideOfHouse"}},entranceToKitchen:{name:"Entrance to the Kitchen",description:"The kitchen entrance must have also served as a dining area at one time. There is a table in the middle of the space and the floor is riddled with broken dishes.",exits:{s:"backOfHallway",e:"kitchen"},scenery:{table:"The surface is scarred with knife marks and reddish brown stains, as though a large carcass was butchered here.",dishes:"They crunch under your feet.",stains:"Blood? Let's hope it's just ketchup. Unless they were preparing hotdogs, because only a monster would put ketchup on a hotdog."}},kitchen:{name:"Kitchen and Grimy Cooker",description:"A grimy iron cooker fills most of the space of the kitchen. A few pots lie scattered about but most of the cookware and cutlery has long since been looted.",exits:{w:"entranceToKitchen",e:"sculleryDoor"},scenery:{cooker:"It is unusable. Covered in grime and rust from years of neglect.",pots:"They are rusty and covered in muck.",grime:"Yuck!",muck:"Gross!"}},sculleryDoor:{name:"Scullery Door",description:"A dented old washbasin is all that remains here in the scullery. To the north an exit leads outside to the back of the house.",exits:{n:"yard",w:"kitchen"},scenery:{washbasin:"You doubt it can still hold water."}},dustyRoom:{name:"Dusty Room",description:"Room with Inches of Dust",exits:{s:"spiralStaircase",e:"rearTurretRoom"}},rearTurretRoom:{name:"Rear Turret Room",exits:{w:"dustyRoom"}},clearing:{name:"Clearing by House",exits:{n:"thickForest",e:"path"}},path:{name:"Path",exits:{n:"blastedTree",s:"clifftop",w:"clearing"}},sideOfHouse:{name:"Side of House",description:"As you make your way down the side of the house, you notice a message hastily scrawed on the siding here.",exits:{n:"cornerOfHouse",s:"crumblingWall"},scenery:{siding:"There's a message scrawled on it."}},backOfHallway:{name:"Back Hallway",description:"The hallway appears to be coming to an end here. There is a portrait hanging on the wall. The cased opening to the north leads to the kitchen.",exits:{n:"entranceToKitchen",s:"gloomyPassage"},scenery:{portrait:"The tapestry depicts an elderly woman in a black dress. She stands aside an old tree.",tapestry:"It depicts an elderly woman in a black dress. She stands aside an old tree.",woman:"I think her eyes just moved!",eyes:"They seem to follow you around the room.",tree:"The tree is barren and looks like there is a rope tied to one of the branches.",rope:"Maybe it's just a vine? The artist was not that keen on details.",dress:"It's a lacy number like they used to wear in the nineteenth century."}},darkAlcove:{name:"Dark Alcove",exits:{s:"poolOfLight",e:"smallDarkRoom"},darkness:!0},smallDarkRoom:{name:"Small Dark Room",exits:{w:"darkAlcove",e:"spiralStaircase"}},spiralStaircase:{name:"Spiral Staircase",description:"Bottom of Spiral Staircase",exits:{n:"dustyRoom",w:"smallDarkRoom",u:"dustyRoom",d:"smallDarkRoom"}},widePassage:{name:"Wide Passage",exits:{s:"trophyRoom",e:"slipperySteps"}},slipperySteps:{name:"Slippery Steps",exits:{w:"widePassage",s:"cellar",u:"widePassage",d:"cellar"}},clifftop:{name:"Clifftop",exits:{n:"path",s:"cliffPath"}},crumblingWall:{name:"Crumbling Wall",description:"Here, further progress is blocked by a crumbling wall.",exits:{n:"sideOfHouse"},scenery:{wall:"You dare not approach it for fear of being hit by a falling piece of masonry."}},gloomyPassage:{name:"Gloomy Passage",description:"This long, gloomy section of hallway continues north and south.",exits:{n:"backOfHallway",s:"frontHall"}},poolOfLight:{name:"Pool of Light",exits:{n:"darkAlcove",e:"vaultedHall",s:"sittingRoom"}},vaultedHall:{name:"Impressive Vaulted Hallway",exits:{w:"darkAlcove",e:"hallWithLockedDoor"},darkness:!0},hallWithLockedDoor:{name:"Hall by Thick Wooden Door",exits:{w:"vaultedHall",e:"trophyRoom"},darkness:!0},trophyRoom:{name:"Trophy Room",exits:{n:"widePassage",s:"diningRoom",w:"hallWithLockedDoor"},darkness:!0},cellar:{name:"Cellar With Barred Window",description:"The air in this cellar is damp with moisture. There is a barred window on the east wall.",exits:{n:"slipperySteps",s:"deepCellar"},scenery:{window:"The window has long since been smashed open, but there are bars blocking your exit.",bars:"The bars are planted in front of the window. However, the moisture appears to have softened the brickwork around the frame.",bricks:"They aren't as rigid as they once were.",brickwork:"It isn't as rigid as it once was."}},cliffPathByWindow:{name:"Cliff Path by Window",exits:{n:"clifftop",s:"cliffPath"}},cupboard:{name:"Cupboard With Hanging Coats",description:"This tiny side room off of the main closet is where old garments are stored.",exits:{s:"closet"}},frontHall:{name:"Front Hall",description:"The entranceway ends here. To the north is a long hallway leading towards the back of the house. To the east are the main rooms of the mansion",exits:{n:"gloomyPassage",e:"sittingRoom",s:"frontLobby"}},sittingRoom:{name:"Sitting Room",exits:{n:"poolOfLight",w:"frontHall",s:"library"}},secretRoom:{name:"Secret Room",exits:{s:"study"}},steepMarbleStairs:{name:"Steep Marble Stairs",exits:{n:"hallWithLockedDoor",s:"cobwebbyRoom",u:"hallWithLockedDoor",d:"cobwebbyRoom"}},diningRoom:{name:"Dining Room",exits:{n:"trophyRoom"}},deepCellar:{name:"Deep Cellar with Coffin",exits:{n:"cellar"}},cliffPath:{name:"Cliff Path",exits:{n:"cliffPathByWindow",s:"cliffPathByMarsh"}},closet:{name:"Closet",description:"The front closet is large and mosty empty. You notice a small opening to the north that leads to the cupboard.",exits:{n:"cupboard",e:"frontLobby"},scenery:{opening:"I think you can squeeze through."}},frontLobby:{name:"Front Lobby",description:"The entrance to the old mansion is cold and your footsteps echo off the marbled floor. The door through which you entered is sealed shut.",exits:{n:"frontHall",w:"closet"},onEnter:function(){flags.frontDoorOpen&&(message="With a tremendous &quot;BANG!&quot; the door slams shut behind you.",sndDoor.play(),flags.frontDoorOpen=!1,delete rooms.frontPorch.exits.n)},scenery:{door:"No matter how much you try, it won't open. You'll need to find another way out.",floor:"The floor is in surprisingly good shape considering its age."}},library:{name:"Library of Evil Books",exits:{n:"sittingRoom",e:"study"}},study:{name:"The Study",exits:{w:"library"},description:"This must be where mansion's owner spent many hours sitting at a one of the many desks researching the dark arts. In addition to the desks you notice a small hole in the wall.",scenery:{wall:"I seems brittle. You may be able to chop your way through.",hole:"There's something beyond..."}},cobwebbyRoom:{name:"Weird Cobwebby Room",exits:{n:"steepMarbleStairs",e:"coldChamber",s:"upperGallery"}},coldChamber:{name:"Very Cold Chamber",exits:{w:"cobwebbyRoom",e:"spookyRoom"}},spookyRoom:{name:"Spooky Room",exits:{w:"coldChamber"}},cliffPathByMarsh:{name:"Cliff Path by Marsh",description:"The path ends here at the edge of a boggy marsh. Travelling south could be very dangerous.",exits:{n:"cliffPath",s:"soggyPath"},shore:!0},verandah:{name:"Rubble-Strewn Verandah",description:"Here the mansion's verandah ends. Like the rest of the house it is strewn with rubble.",exits:{s:"twistedRailings",e:"frontPorch"},scenery:{rubble:"The rubble is comprised of various bits and pieces that have fallen from the structure of the house."}},frontPorch:{name:"Front Porch",description:"The front porch of the mansion is weather worn and rotting. To the north, the ornately carved front doorway of the mansion beckons.",exits:{n:"frontLobby",w:"verandah",s:"pathThroughIronGate"},scenery:{doorway:"The carvings depict various sinister creatures.",carvings:"The carvings depict various sinister creatures."}},frontTower:{name:"Front Tower",exits:{e:"slopingCorridor"}},slopingCorridor:{name:"Sloping Corridor",exits:{w:"frontTower",e:"upperGallery"}},upperGallery:{name:"Upper Gallery",description:"The relative calm of this room feels wrong.",exits:{n:"cobwebbyRoom",w:"slopingCorridor"},onEnter:function(){flags.ghostsAttacking?this.description="You shudder with fear as flurry of ghosts circles you, blocking your movement.":this.description="The relative calm of this room feels wrong."},onExit:function(){flags.ghostsAttacking?this.description="You shudder with fear as flurry of ghosts circles you, blocking your movement.":this.description="The relative calm of this room feels wrong."}},marshByWall:{name:"Marsh by Wall",description:"The ground here beneath the south wall is wet and muddy. To the east it becomes marshland-sticky and impassable by foot.",exits:{s:"fallenBrickwork",e:"marsh"},shore:!0},marsh:{name:"Marsh",description:"This boggy marsh looks deep and forboding. Clouds of tiny bugs flitter around your head and bite at your flesh. Best not linger here too long.",exits:{e:"soggyPath",w:"marshByWall"},scenery:{bugs:"They are too small too really hurt you but provide a constant annoyance.",clouds:"Not quite a swarm, but enough to make you want to move on.",marsh:"The water is dark and you can't see the bottom."},water:!0},soggyPath:{name:"Soggy Path",description:"The path here has been flooded by the ever-encroaching marshlands to the west. Steep cliff blocks your passage to the south.",exits:{n:"cliffPathByMarsh",w:"marsh"},scenery:{cliff:"There is no way to climb it."},water:!0},twistedRailings:{name:"The Twisted Railing",description:"The fence ends here in a twisted mass of barbs and rusty edges.",exits:{n:"verandah",e:"pathThroughIronGate"},scenery:{fence:"It's just an ordinary haunted fence. There is no way around it.",barbs:"The barbs look sharp and dangerous, best not mess with them.",mass:"The barbs look sharp and dangerous, best not mess with them."}},pathThroughIronGate:{name:"Path Through Iron Gate",description:"The wind howls as you make your way to the entrance of the property. The old mansion looms ahead of you silhouetted against a full moon.",exits:{n:"frontPorch",w:"twistedRailings",e:"pathByRailings"},scenery:{gate:"The gate is old and rusted.",mansion:"You wonder what treasures await you inside.",moon:"The moon provides just enough light to make your way visible."},onExit:function(){message="And so you begin your adventure...",delete this.onExit}},pathByRailings:{name:"Path by Railings",description:"Here the path runs west towards the entrance and continues east towards the base of the front tower.",exits:{w:"pathThroughIronGate",e:"beneathTower"},scenery:{railings:"The metal railings block your exit to the south.",path:"The path is muddy and overgrown with vegetation."}},beneathTower:{name:"Beneath the Front Tower",description:"Above you looms the dark front tower of the mansion. Who knows what horrors lurk up there.",exits:{w:"pathByRailings",e:"debris"},scenery:{tower:"The menacing tower rises above you into the moonlit sky."}},debris:{name:"Pile of Debris",description:"Here the facade of the mansion has crumbled and all that remains is a pile of broken debris.",exits:{w:"beneathTower",e:"fallenBrickwork"},scenery:{debris:"It's just a messy pile of building materials.",pile:"The pile of building materials is impassable.",facade:"It must have been stunning when it was new."}},fallenBrickwork:{name:"Large Fallen Brickwork",description:"All around lies the remnants of decayed brickwork. The ground towards the north looks marshy and dangerous.",exits:{n:"marshByWall",w:"debris",e:"stoneArch"},scenery:{brickwork:"The nineteenth century masonry could not withstand this stormy climate."}},stoneArch:{name:"Rotting Stone Arch",description:"Here you pass under a decaying stone arch. To the east the path leads upwards towards a clifftop. To the north you see a murky bog.",exits:{w:"fallenBrickwork",e:"crumblingClifftop"},scenery:{arch:"In happier times the owners must have strolled here regularly.",bog:"It looks impassable on foot."}},crumblingClifftop:{name:"Crumbling Clifftop",description:"You are standing at the top of a cliff. Below you to the north you see the marshy, impassable wetlands.",exits:{w:"stoneArch"},scenery:{cliff:"Your stomach begins to flutter as you peer over the edge.",wetlands:"You don't want to get caught in there without a boat."}},inTheTree:{name:"In the Blasted Tree",description:"From up in the tree you see a thick forest and a cliff to the south.",exits:{d:"blastedTree"},onEnter:function(){message="You use the rope to climb the tree."}}},verbs={help:{default:'"God helps those who help themselves."',action:function(e,o){if(message='Haunted House is a text adventure. You perform actions by typing two word commands such as "TAKE RING" or "LOOK PAINTING". Explore the house and try to find the treasures within. For clues, be sure to "LOOK" at everything!<br><br>For more help type the following:<br>"HELP MOVEMENT" or "HELP COMMANDS"',"movement"!==e)if("commands"!==e)if("verbs"!==e)e&&(message=verbs.help.default);else{var t="";for(var a in verbs)a.length>1&&(t+=a+", ");message="<b>Words I know:</b>  ".concat(t.substring(0,t.length-2))}else message='There are several special commands in the game. "INVENTORY" or "I" will list the objects you are carrying. "SCORE" will reveal your current score. Some of the most useful verbs are "LOOK", "TAKE", and "DROP".<br><br>For a complete list of all the verbs I know type "HELP VERBS". But wait until you a really stuck before resorting to that.';else message='You can move around the mansion by typing "GO NORTH", "GO WEST", "GO UP", etc. Save keystrokes by simply entering a single initial of the direction you want to move: "N","S","E","W","U" and "D".<br><br>Available exits are listed below the room description.'},singleWord:!0},carrying:{action:function(e,o){if(!e){var t="";for(var a in objects)"player"===objects[a].location&&(t.length>0?t+=", ":t="<br>",t+=objects[a].name);t||(t="Nothing."),message="You are carrying: ".concat(t)}},singleWord:!0},inventory:{synonym:"carrying",singleWord:!0},i:{synonym:"carrying",singleWord:!0},go:{action:function(e,o){var t;switch(e){case"north":t="n";break;case"south":t="s";break;case"west":t="w";break;case"east":t="e";break;case"up":t="u";break;case"down":t="d";break;case"boat":return void verbs.enter.action("boat",objects.boat);default:return void(message="You need to specify a direction in which to&nbsp;<em>GO</em>.")}var a=currentRoom.exits[t.toLowerCase()];if(flags.ghostsAttacking&&isRoom("upperGallery"))message="The ghosts won't let you move!";else if(!currentRoom.darkness||flags.candleLit)if(flags.batsAttacking&&isRoom("rearTurretRoom"))message="The bats are preventing your movement.";else if(isRoom("coldChamber")&&flags.magicalBarrier&&"w"===t)message="A magical barrier is blocking your way to the west.";else if(!currentRoom.water||flags.inBoat)if(t&&a){var s=previousRoom;if(message="OK",previousRoom=currentRoom,(currentRoom=getRoom(a)).darkness&&!flags.candleLit)return currentRoom=previousRoom,previousRoom=s,void(message="It's too dark in that direction. You'll need a light.");if((currentRoom.water||currentRoom.shore)&&flags.inBoat&&(objects.boat.location=currentRoom.rid,message="Aye aye captain"),currentRoom.water&&!flags.inBoat)return currentRoom=previousRoom,previousRoom=s,void(message="You need a way to navigate the bog.");if(!currentRoom.water&&!currentRoom.shore&&flags.inBoat)return currentRoom=previousRoom,previousRoom=s,void(message="You need to exit the boat first.");previousRoom.onExit&&previousRoom.onExit(),currentRoom.onEnter&&currentRoom.onEnter()}else message=t?"You can't go that way!":"GO WHERE?";else message="The marshy ground prevents any movement.";else message="It's too dark to move!"}},n:{action:function(e,o){e||verbs.go.action("north")},singleWord:!0},north:{synonym:"n"},s:{action:function(e,o){e||verbs.go.action("south")},singleWord:!0},south:{synonym:"s"},w:{action:function(e,o){e||verbs.go.action("west")},singleWord:!0},west:{synonym:"w"},e:{action:function(e,o){e||verbs.go.action("east")},singleWord:!0},east:{synonym:"e"},u:{action:function(e,o){e||verbs.go.action("up")},singleWord:!0},up:{synonym:"u"},d:{action:function(e,o){e||verbs.go.action("down")},singleWord:!0},down:{synonym:"d"},get:{action:function(e,o){if(message='What "'.concat(e.toUpperCase(),'?"'),!o&&currentRoom.scenery)for(var t in currentRoom.scenery)if(t.toLowerCase()==e.toLowerCase())return void(message="You can't take that.");if(o.portable&&objectInRange(o)){if(o.location===currentRoom.rid)return message="Taken.",void(o.location="player");if("player"===o.location)return void(message="You already have it!")}o.portable||!objectInRange(o)||o.location!==currentRoom.rid||(message="You don't need to take that.")}},take:{synonym:"get"},open:{action:function(e,o){message="You can't open that."}},look:{default:"You see nothing special.",action:function(e,o){if(e)if(o.description&&objectInRange(o))message=o.description;else if(o.description)message="You do see that here.";else{if(currentRoom.scenery)for(var t in currentRoom.scenery)if(t.toLowerCase()==e.toLowerCase())return void(message=currentRoom.scenery[t]);message="You see nothing special."}else message="You look around."}},examine:{synonym:"look"},read:{action:function(e,o){message=o.readable&&objectInRange(o)?o.readableText:"Nothing to read there."}},say:{action:function(e,o){message="You say, &quot;"+e.toUpperCase()+"!&quot;","xzanfar"===e&&isCarrying("magic spells")?isRoom("coldChamber")&&flags.magicalBarrier?(message+="<br><br>The air sizzles with energy and the magic field dissipates into nothingness.",flags.magicalBarrier=!1):isRoom("coldChamber")?(message+="<br><br>The magical field re-materializes!",flags.magicalBarrier=!0):message+="<br><br>*Magic Occurs*":nounCheck(e,["fuck","shit","cunt","tits"])&&(message+="<br><br>Relax. It's just a game.")}},dig:{singleWord:!0,action:function(e,o){message="You can't dig that.",isCarrying("shovel")?e?isRoom("cellar")&&nounCheck(e,["bars","window","barred window","brickwork","bricks"])&&(flags.barsDug?message="You've already cleared the bars away from the window.":(message="After several minutes of work, you manage to dig the bars out.",flags.barsDug=!0,rooms.cellar.exits.e="cliffPath",rooms.cellar.name="Cellar with Hole in the Wall",rooms.cellar.description="The air in this cellar is damp with moisture. To the east, what once was a barred window is now a hole large enough to pass through.",rooms.cliffPath.exits.w="cellar")):message="Where do you want to dig?":message="You have nothing to dig with."}},swing:{default:"There's no reason to be swinging that.",action:function(e,o){if(message=verbs.swing.default,"rope"===o.id&&flags.ropeTiedToTree&&isRoom("blastedTree"))message="This is no time to be playing games.";else{if("rope"!==o.id||!isCarrying(["rope"]))return"axe"===o.id&&isCarrying("axe")&&isRoom("study")&&!flags.studyWallBroken?(message="You broke the thin wall.",flags.studyWallBroken=!0,currentRoom.exits.n="secretRoom",currentRoom.name="Study with Secret Room",currentRoom.description="This must be where mansion's owner spent many hours sitting at a one of the many desks researching the dark arts. In addition to the desks, to the north there is a passage leading to a secret room",currentRoom.scenery.hole="The hole is much bigger now.",currentRoom.scenery.wall="The wall is no more. A secret room lies to the north.",void(currentRoom.scenery.passage="It leads north to a secret room.")):void("axe"===o.id&&isCarrying("axe")&&(isRoom("forest")||isRoom("thickForest")||isRoom("blastedTree"))?message="Don't chop the trees. You get the feeling it would anger the woodland spirits.":"axe"===o.id&&isCarrying("axe")&&(message="Whoosh!!!"));message="You swung it. Yee haw, cowboy!"}}},chop:{action:function(e,o){message="You don't need to chop that.",isCarrying("axe")?verbSubroutine("swing","axe",verbs.swing,objects.axe):message="Not with your bare hands. You're karate skills aren't what they used to be."}},climb:{default:"You can't climb that.",action:function(e,o){message=verbs.climb.default,"tree"===e&&flags.ropeTiedToTree&&isRoom("blastedTree")?objects.rope.overrides.climb():"tree"===e&&flags.ropeTiedToTree&&isRoom("inTheTree")&&verbs.go.action("down")}},light:{default:"You can't light that.",action:function(e,o){message=verbs.light.default,"player"===objects.matches.location?"candle"===e&&isCarrying("candle")&&isCarrying("candlestick")?flags.candleLit?message="It's already lit.":(message="It casts a flickering light.",flags.candleLit=!0):"candle"!==e||!isCarrying("candle")||isCarrying("candlestick")?"aerosol"===e&&isCarrying("aerosol")?message="An explosive fireball sprays out of the can of aerosol! You can kiss your eyebrows goodbye.":"cooker"!==e&&"stove"!==e||"kitchen"!==currentRoom.rid?"rubbish"!==e||"yard"!==currentRoom.rid||(message="It's too damp to light."):message="The cooker is in no state to be lit.":message="It will burn your hands!":message="You have nothing to light it with."}},unlight:{default:"You can't do that.",action:function(e,o){if(message=verbs.unlight.default,"candle"===e&&flags.candleLit)return message="You blow out the candle.",void(flags.candleLit=!1)}},extinguish:{synonym:"unlight"},spray:{default:"You can't spray that!",action:function(e,o){if(message=verbs.spray.default,"aerosol"===o.id&&isCarrying("aerosol")&&flags.batsAttacking)return flags.batsAttacking=!1,void(message="Pfft! Got 'em!");"aerosol"===o.id&&isCarrying("aerosol")&&(message="Hisssss...")}},use:{default:"You are going to need to be more specific.",action:function(e,o){if("aerosol"!==o.id)return"vacuum"===o.id&&isCarrying("vacuum")&&isCarrying("batteries")&&!flags.vacuumSwitchedOn?(message="The vacuum is switched on.",void(flags.vacuumSwitchedOn=!0)):"vacuum"===o.id&&isCarrying("vacuum")&&isCarrying("batteries")&&flags.vacuumSwitchedOn?(message="The vacuum is switched off.",void(flags.vacuumSwitchedOn=!1)):void("vacuum"!==o.id||!isCarrying("vacuum")||isCarrying("batteries")||(message="This vacuum requires batteries."));verbs.spray.action(e,o)}},unlock:{default:"You can't unlock that.",action:function(e,o){message=verbs.unlock.default,o.locked&&o.key&&objectInRange(o)&&isCarrying(o.key)?(message="You've unlocked the ".concat(e,"."),o.locked=!1):o.locked&&o.key&&objectInRange(o)?message="You don't have a means to unlock that.":o.locked&&objectInRange(o)&&"You've unlocked the ".concat(e,".")}},drop:{action:function(e,o){return"player"===o.location?(o.location=currentRoom.rid,void(message="Dropped.")):"boat"===e&&flags.inBoat?(message="You jump out of the boat.",currentRoom.water&&(message+=" SPLASH!<br>"),void(flags.inBoat=!1)):void 0}},leave:{synonym:"drop"},enter:{action:function(e,o){if(message="You can't enter that.","boat"===e&&objectInRange("boat")&&!flags.inBoat)return message="You board the boat.",flags.sinking=0,void(flags.inBoat=!0);"boat"===e&&objectInRange("boat")&&flags.inBoat?message="You are already onboard.":"boat"!==e||(message="There is no boat here.")}},board:{synonym:"enter"},exit:{action:function(e,o){message="You can't exit that.","boat"!==e||verbs.drop.action("boat",objects.boat)}},wear:{action:function(e,o){if(message="You can't wear that.","coat"===e&&isCarrying("coat")&&!flags.wearingCoat)return message="You put on the coat. Stylish.","coat"===objects.key.location&&(message+=" Wait, there is something in the pocket!"),void(flags.wearingCoat=!0);"coat"===e&&isCarrying("coat")&&flags.wearingCoat?message="You are already wearing it.":"coat"!==e||isCarrying("coat")||(message="You don't have a coat.")}},remove:{action:function(e,o){if("coat"===e&&isCarrying("coat")&&flags.wearingCoat)return message="You remove the coat",void(flags.wearingCoat=!1);"coat"!==e||!isCarrying("coat")||flags.wearingCoat||(message="You are not wearing it.")}},score:{action:function(e,o){message="Your score is ".concat(checkScore(),"/").concat(getMaxScore(),"."),0===checkScore()&&(message+=" You need to find some treasure!"),checkScore()===getMaxScore()&&(message+=" That's everything. Hurry, find your way back to the front gate to escape.")},singleWord:!0}},$display=document.getElementById("hh-output"),$inputZone=document.getElementById("hh-input"),$userInput=document.getElementById("hh-userInput"),$inputForm=document.getElementById("hh-input-form"),$restartBtn=document.getElementById("hh-reload"),totalScore=0,winner=!1,lightLevel=60,currentRoom=rooms.pathThroughIronGate,previousRoom=null,message="OK";for(var _room in rooms)rooms[_room].rid=_room;for(var key in verbs)verbs[key].name=key;for(var _key in objects)objects[_key].id=_key,objects[_key].name||(objects[_key].name=_key);var flags={frontDoorOpen:!0,candleLit:!1,ghostsAttacking:!1,vacuumSwitchedOn:!1,batsAttacking:!1,magicalBarrier:!0,hallDoorLocked:!0,barsDug:!1,ropeTiedToTree:!0,studyWallBroken:!1,inBoat:!1,sinking:0,wearingCoat:!1};function display(){var e=getExtraDescription(currentRoom),o=getObjectsInRoom(currentRoom);cls(),prnt("HAUNTED HOUSE"),prnt("---------------------------------------------<br>"),prnt('<span class="room-name">'.concat(currentRoom.name,"</span>")),e&&currentRoom.description?prnt("<br>".concat(currentRoom.description," ").concat(e)):e?prnt("<br>".concat(e)):currentRoom.description&&prnt("<br>".concat(currentRoom.description)),prnt('<br><span class="exits">Exits:</span>'.concat(splitExits(currentRoom.exits))),o&&prnt(o),prnt("<br>---------------------------------------------<br>"),prnt('<span class="message">'.concat(message,"</span>")),message="What?",debugInfo()}function getExtraDescription(e){var o="";return objects.boat.location===e.rid&&(flags.inBoat?o+="You are in the boat.":o+="There is a boat here."),""===o&&(o=!1),o}function getObjectsInRoom(e){var o="";for(var t in objects)objects[t].location==e.rid&&objects[t].portable&&(o+='<br/><span class="message objects-in-room">You can see '.concat(objects[t].name," here.</span>"));return""===o&&(o=!1),o}function prnt(e){$display.innerHTML+=e+"<br>"}function cls(){$display.innerHTML=""}function splitExits(e){if(!e)return"No exits!";var o="";for(var t in e)o+=t.toUpperCase()+", ";var a=(o=o.replace(new RegExp(", $"),"")).lastIndexOf(", ");return""==(o=o.slice(0,a)+o.slice(a).replace(", "," &amp; "))?"No exits!":o}function parseInput(e){e=e.trim().toLowerCase();for(var o=null,t=null,a=0;a<e.length;a++){if(" "===e.substring(a,a+1)&&!o){o=e.substring(0,a),t=e.substring(a+1,e.length).trim();break}if(e.indexOf(" ")<0){o=e.trim(),t=null;break}}var s=getVerb(o),r=getNoun(t);s.synonym&&(s=getVerb(o=s.synonym)),r.synonym&&(r=getNoun(t=r.synonym));var n=!1;if(t&&!r&&(message="That's silly!"),t||s.singleWord||(message="I need two words.",n=!0),!s&&r&&(message="You can't &quot;"+e+".&quot;"),s||r||(message="You don't make sense."),s&&r.portable&&"player"!=r.location&&(message="You don't have '"+t+"'"),isRoom("cobwebbyRoom")&&Math.random()<.5&&!flags.vacuumSwitchedOn&&(flags.ghostsAttacking=!0),flags.candleLit&&lightLevel--,n||verbSubroutine(o,t,s,r),lightLevel>1&&lightLevel<11&&(message+="<br>Your candle is waning!"),1==lightLevel&&(message+="<br>Your candle has gone out!",flags.candleLit=!1,lightLevel=0,objects.candle.location=null),isCarrying("vacuum")&&isCarrying("batteries")&&flags.vacuumSwitchedOn&&isRoom("upperGallery")&&flags.ghostsAttacking&&(message+="<br>You've sucked up all the ghosts!",flags.ghostsAttacking=!1),flags.batsAttacking&&(message+="<br>Bats attacking!"),currentRoom.water&&!flags.inBoat){if(flags.sinking++,message+="<br>You are sinking in the bog!",flags.sinking>3)return void death("Flailing and struggling, you sink deeper and deeper into the sticky bog. Despite your efforts, the water envelops you.");3===flags.sinking&&(message+=" Do something, quick!")}display()}function getVerb(e){for(var o in verbs)if(o==e)return verbs[o];return!1}function getNoun(e){for(var o in objects)if(o==e)return objects[o];return!1}function verbSubroutine(e,o,t,a){a.hasOwnProperty("overrides")&&(objectInRange(a)||a.omnipresence)&&a.overrides.hasOwnProperty(e)?a.overrides[e]():t&&t.action(o,a)}function checkScore(){var e=0;for(var o in e=0,objects)"player"==objects[o].location&&objects[o].score&&(e+=objects[o].score);return e}function getMaxScore(){var e=0;for(var o in objects)objects[o].score&&(e+=objects[o].score);return e}function getRoom(e){return rooms[e]}function getObject(e){return objects[e]}function death(e){$inputZone.remove(),cls(),prnt("HAUNTED HOUSE"),prnt("---------------------------------------------<br>"),prnt('<span class="message">'.concat(e,"</span>")),prnt('<br><span class="room-name">You Have Died!</span>'),prnt("<br>---------------------------------------------<br>"),prnt("Your final score is: ".concat(score,".")),$restartBtn.classList.remove("is-hidden")}function objectInRange(e){return"string"==typeof e&&(e=getObject(e)),!(e.location!=currentRoom.rid&&"player"!=e.location&&!e.omnipresence)}function isCarrying(e){return"player"===objects[e].location}function isRoom(e){return currentRoom.rid===e}function nounCheck(e,o){return o.includes(e)}function sound(e){this.sound=document.createElement("audio"),this.sound.src=e,this.sound.setAttribute("preload","auto"),this.sound.setAttribute("controls","none"),this.sound.style.display="none",document.body.appendChild(this.sound),this.play=function(){this.sound.play()},this.stop=function(){this.sound.pause()}}$inputForm.addEventListener("submit",(function(e){parseInput($userInput.value.toUpperCase()),checkScore()>=17&&57==room&&parseInput("SCORE"),$userInput.value="",e.preventDefault()})),$restartBtn.addEventListener("click",(function(e){location.reload(),e.preventDefault()}));var sndOwl=new sound("audio/owl.mp3"),sndDoor=new sound("audio/door.mp3"),sndKey=new sound("audio/key.mp3");function cl(e){e?console.log(e):console.log("hit!")}function debugInfo(){debug&&(console.clear(),cl("lightLevel: "+lightLevel),cl("score: "+totalScore),cl("sinking: "+flags.sinking))}var debug=!0;debug&&(currentRoom=rooms.darkCorner),display(),$userInput.focus();var $btnSmaller=document.getElementById("btnSmaller"),$btnBigger=document.getElementById("btnBigger"),$html=document.querySelector("html"),htmlFontSize=16;$html.style.fontSize=htmlFontSize+"px",$btnSmaller.addEventListener("click",(function(e){e.preventDefault(),--htmlFontSize<8&&(htmlFontSize=8),$html.style.fontSize=htmlFontSize+"px"})),$btnBigger.addEventListener("click",(function(e){e.preventDefault(),++htmlFontSize>36&&(htmlFontSize=36),$html.style.fontSize=htmlFontSize+"px"}));
//# sourceMappingURL=Haunted-House-dist.js.map